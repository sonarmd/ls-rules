{
  "name": "Dev Tools \u2014 Scoped Destinations",
  "description": "Allow dev tools to reach their specific, known destinations. git/gh are IP-pinned to GitHub's published ASes. brew, npm, docker, terraform, gcloud, aws use domain rules. Volta shim covers all Node/npm/yarn traffic.",
  "rules": [
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/git",
      "remote-addresses": "140.82.112.0/20",
      "ports": "22",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "git SSH \u2192 GitHub AS36459 primary range"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/git",
      "remote-addresses": "192.30.252.0/22",
      "ports": "22",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "git SSH \u2192 GitHub AS36459 secondary range"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/git",
      "remote-addresses": "143.55.64.0/20",
      "ports": "22",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "git SSH \u2192 GitHub Actions/Packages range"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/git",
      "remote-addresses": "140.82.112.0/20",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "git HTTPS \u2192 GitHub"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/git",
      "remote-addresses": "192.30.252.0/22",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "git HTTPS \u2192 GitHub secondary"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/gh",
      "remote-addresses": "140.82.112.0/20",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "gh CLI \u2192 GitHub API"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/gh",
      "remote-addresses": "192.30.252.0/22",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "gh CLI \u2192 GitHub API secondary"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/Library/Homebrew/vendor/portable-ruby/current/bin/ruby",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Homebrew Ruby \u2192 GitHub (formula/tap updates)"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/Library/Homebrew/vendor/portable-ruby/current/bin/ruby",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Homebrew Ruby \u2192 GitHub Container Registry (bottle downloads)"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/Library/Homebrew/vendor/portable-ruby/current/bin/ruby",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Homebrew Ruby \u2192 Homebrew formula API"
    },
    {
      "action": "allow",
      "process": "/usr/bin/curl",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "curl used by Homebrew for bottle downloads from GitHub Container Registry"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/opt/volta/bin/volta-shim",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Node/npm/yarn (via Volta shim) \u2192 npm registry"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/opt/volta/bin/volta-shim",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Volta \u2192 Node.js download mirror"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/opt/volta/bin/volta-shim",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Volta \u2192 Yarn package registry"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/terraform",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Terraform \u2192 provider registry"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/terraform",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Terraform \u2192 HashiCorp release downloads"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/terraform",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "Terraform \u2192 version check (can disable with CHECKPOINT_DISABLE=1)"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/gcloud",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "gcloud \u2192 Google Cloud APIs"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/gcloud",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "gcloud \u2192 Google auth endpoints"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/aws",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "AWS CLI \u2192 AWS service endpoints"
    },
    {
      "action": "allow",
      "process": "/opt/homebrew/bin/aws",
      "ports": "443",
      "protocol": "tcp",
      "direction": "outgoing",
      "notes": "AWS CLI \u2192 AWS management console/SSO"
    }
  ]
}
