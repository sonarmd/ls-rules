{
  "$schema": "https://obdev.at/littlesnitch/lsrules-schema.json",
  "name": "Tony Fortress \u2014 Paranoid",
  "description": "Maximum restriction ruleset. Allowlists only essential OS processes, CLI dev tooling, and core apps. Blocks all macOS telemetry, analytics, iCloud, Siri, Find My, stock consumer apps, and unsolicited inbound. Designed to be layered on top of ghost-baseline.",
  "rules": [
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/libexec/configd",
      "protocol": "udp",
      "ports": [
        67,
        68
      ],
      "notes": "DHCP client: get IP address and gateway"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/sbin/mDNSResponder",
      "protocol": "udp",
      "ports": [
        53,
        853
      ],
      "notes": "DNS (UDP) - allow classic and DNS-over-TLS"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/sbin/mDNSResponder",
      "protocol": "tcp",
      "ports": [
        53,
        853
      ],
      "notes": "DNS (TCP) - fallback, large answers"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/libexec/trustd",
      "protocol": "tcp",
      "ports": [
        80
      ],
      "remote-addresses": "17.248.0.0/15,17.250.0.0/16,17.253.0.0/16",
      "notes": "Apple trustd - certificate revocation / trust lists"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/sbin/ocspd",
      "protocol": "tcp",
      "ports": [
        80
      ],
      "remote-addresses": "17.248.0.0/15,17.250.0.0/16,17.253.0.0/16",
      "notes": "OCSP daemon - certificate status"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/sbin/softwareupdated",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "remote-addresses": "17.0.0.0/8",
      "notes": "macOS software updates (system + XProtect)"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/System/Library/PrivateFrameworks/CommerceKit.framework/Resources/storeaccountd",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "remote-addresses": "17.0.0.0/8",
      "notes": "App Store account for update entitlements only"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/sbin/ntpd",
      "protocol": "udp",
      "ports": [
        123
      ],
      "notes": "NTP - system time sync"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/bin/ssh",
        "/opt/homebrew/bin/ssh"
      ],
      "protocol": "tcp",
      "ports": [
        22,
        443
      ],
      "notes": "SSH client (plain + HTTPS-tunneled SSH)"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/bin/git",
        "/opt/homebrew/bin/git"
      ],
      "protocol": "tcp",
      "ports": [
        22,
        443,
        9418
      ],
      "notes": "Git over SSH/HTTPS/git protocol"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/bin/curl",
        "/opt/homebrew/bin/curl",
        "/usr/bin/wget"
      ],
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "curl / wget - HTTP(S) only"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/local/bin/brew",
        "/opt/homebrew/bin/brew"
      ],
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Homebrew package manager"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/bin/python3",
        "/usr/local/bin/python3",
        "/opt/homebrew/bin/python3"
      ],
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Python 3 - pip and scripts reaching internet"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/usr/bin/node",
        "/usr/local/bin/node",
        "/opt/homebrew/bin/node"
      ],
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Node.js - npm/yarn tooling"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/local/bin/npm",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "npm - JS package manager"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/bin/go",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Go tooling"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/local/bin/docker",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Docker CLI"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Xcode.app/Contents/MacOS/Xcode",
      "protocol": "tcp",
      "ports": [
        22,
        80,
        443
      ],
      "notes": "Xcode IDE - package downloads, documentation, Git"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Xcode.app/Contents/Developer/usr/bin/xcodebuild",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "remote-addresses": "17.0.0.0/8",
      "notes": "Xcode build tools - Apple services only"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/usr/bin/codesign",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "remote-addresses": "17.0.0.0/8",
      "notes": "Code signing with Apple"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Chrome - main browser traffic"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/Helpers/Google Chrome Helper.app/Contents/MacOS/Google Chrome Helper",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Chrome Helper - page workers"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",
      "notes": "Chrome - block analytics, safe-browsing, auto-update and connectivity checks"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/DuckDuckGo.app/Contents/MacOS/DuckDuckGo",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "DuckDuckGo browser"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Safari.app/Contents/MacOS/Safari",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Safari browser"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Safari.app/Contents/MacOS/Safari",
      "notes": "Safari - block Apple analytics"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": [
        "/Applications/1Password.app/Contents/MacOS/1Password",
        "/Applications/1Password CLI.app/Contents/MacOS/op"
      ],
      "protocol": "tcp",
      "ports": [
        443
      ],
      "notes": "1Password desktop + CLI"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Teams.app/Contents/MacOS/Teams",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Teams - meetings/chat"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Teams.app/Contents/MacOS/Teams",
      "notes": "Teams - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Word.app/Contents/MacOS/Microsoft Word",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Word - documents and licensing"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Word.app/Contents/MacOS/Microsoft Word",
      "notes": "Word - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Excel.app/Contents/MacOS/Microsoft Excel",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Excel - spreadsheets and licensing"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Excel.app/Contents/MacOS/Microsoft Excel",
      "notes": "Excel - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Outlook.app/Contents/MacOS/Microsoft Outlook",
      "protocol": "tcp",
      "ports": [
        443,
        587,
        993,
        995,
        465
      ],
      "notes": "Outlook - email + calendar (IMAP/SMTP/Exchange)"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Microsoft Outlook.app/Contents/MacOS/Microsoft Outlook",
      "notes": "Outlook - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/OneDrive.app/Contents/MacOS/OneDrive",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "notes": "OneDrive - file sync"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/OneDrive.app/Contents/MacOS/OneDrive",
      "notes": "OneDrive - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Visual Studio Code.app/Contents/MacOS/Electron",
      "protocol": "tcp",
      "ports": [
        22,
        80,
        443,
        9418
      ],
      "notes": "VSCode - SSH, git, extensions, marketplace"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Visual Studio Code.app/Contents/MacOS/Electron",
      "notes": "VSCode - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Sublime Text.app/Contents/MacOS/sublime_text",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Sublime Text - package control and updates"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/iTerm.app/Contents/MacOS/iTerm2",
      "protocol": "tcp",
      "ports": [
        22,
        80,
        443
      ],
      "notes": "iTerm2 - shells, SSH, HTTP(S)"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/iTerm.app/Contents/MacOS/iTerm2",
      "notes": "iTerm2 - block analytics"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Utilities/Terminal.app/Contents/MacOS/Terminal",
      "protocol": "tcp",
      "ports": [
        22,
        80,
        443
      ],
      "notes": "Terminal - SSH and HTTP(S) tools"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Slack.app/Contents/MacOS/Slack",
      "protocol": "tcp",
      "ports": [
        80,
        443
      ],
      "notes": "Slack - messaging and calls"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/Slack.app/Contents/MacOS/Slack",
      "notes": "Slack - block telemetry"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/ChatGPT.app/Contents/MacOS/ChatGPT",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "notes": "ChatGPT desktop app"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": "/Applications/ChatGPT.app/Contents/MacOS/ChatGPT",
      "notes": "ChatGPT - block telemetry/monitoring providers"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Little Snitch.app/Contents/MacOS/Little Snitch",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "notes": "Little Snitch app - updates / license"
    },
    {
      "action": "allow",
      "direction": "outgoing",
      "process": "/Applications/Utilities/Little Snitch Network Monitor.app/Contents/MacOS/Little Snitch Network Monitor",
      "protocol": "tcp",
      "ports": [
        443
      ],
      "notes": "Little Snitch Network Monitor UI"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": [
        "/usr/libexec/analyticsd",
        "/usr/libexec/adprivacyd",
        "/usr/libexec/coreduetd",
        "/usr/libexec/contextstored",
        "/usr/libexec/suggestd",
        "/usr/libexec/rapportd",
        "/usr/libexec/nearbyd",
        "/usr/libexec/sharingd",
        "/usr/libexec/mobileactivationd",
        "/usr/libexec/mobileassetd",
        "/usr/libexec/findmydeviced",
        "/usr/libexec/findmybeaconingd",
        "/usr/libexec/findmylocateagent",
        "/usr/libexec/replayd",
        "/usr/libexec/biomesyncd",
        "/System/Library/PrivateFrameworks/BiomeStreams.framework/Support/biomed",
        "/usr/libexec/gamepolicyd",
        "/usr/libexec/audioanalyticsd",
        "/usr/libexec/intelligentroutingd",
        "/usr/libexec/networkserviceproxy",
        "/usr/libexec/wifip2pd",
        "/usr/libexec/wifianalyticsd",
        "/usr/sbin/bluetoothd",
        "/usr/libexec/imagent",
        "/usr/libexec/identityservicesd",
        "/usr/libexec/IMTransferAgent",
        "/System/Library/CoreServices/CloudDocs.app/Contents/MacOS/CloudDocs",
        "/System/Library/PrivateFrameworks/CloudDocs.framework/Versions/A/Support/clouddocs",
        "/usr/libexec/bird",
        "/System/Library/PrivateFrameworks/CloudServices.framework/Helpers/com.apple.sbd",
        "/usr/libexec/accountsd",
        "/System/Library/CoreServices/TimeMachine/backupd",
        "/System/Library/CoreServices/TimeMachine/backupd-helper",
        "/System/Library/CoreServices/Siri.app/Contents/MacOS/Siri",
        "/System/Library/PrivateFrameworks/AssistantServices.framework/assistantd",
        "/usr/libexec/siriknowledged",
        "/System/Library/PrivateFrameworks/CoreSpeech.framework/corespeechd",
        "/System/Library/PrivateFrameworks/SiriTTSService.framework/sirittsd",
        "/System/Library/CoreServices/AirPlayUIAgent.app/Contents/MacOS/AirPlayUIAgent",
        "/usr/libexec/AirPlayXPCHelper",
        "/usr/libexec/ContinuityCaptureAgent",
        "/usr/libexec/nsurlsessiond",
        "/usr/libexec/remindd",
        "/usr/libexec/photoanalysisd",
        "/usr/libexec/triald",
        "/usr/libexec/triald_system",
        "/usr/libexec/usermanagerd",
        "/usr/libexec/eligibilityd",
        "/usr/libexec/smd"
      ],
      "notes": "Hard kill: macOS analytics, Siri, iCloud, Find My, Continuity, WiFi analytics, TimeMachine, media analysis, experiments"
    },
    {
      "action": "deny",
      "direction": "outgoing",
      "process": [
        "/System/Applications/Mail.app/Contents/MacOS/Mail",
        "/System/Applications/Messages.app/Contents/MacOS/Messages",
        "/System/Applications/Photos.app/Contents/MacOS/Photos",
        "/System/Applications/News.app/Contents/MacOS/News",
        "/System/Applications/Stocks.app/Contents/MacOS/Stocks",
        "/System/Applications/TV.app/Contents/MacOS/TV",
        "/System/Applications/Home.app/Contents/MacOS/Home",
        "/System/Applications/Podcasts.app/Contents/MacOS/Podcasts",
        "/System/Applications/FaceTime.app/Contents/MacOS/FaceTime",
        "/System/Applications/Maps.app/Contents/MacOS/Maps",
        "/System/Applications/Contacts.app/Contents/MacOS/Contacts",
        "/System/Applications/Calendar.app/Contents/MacOS/Calendar",
        "/System/Applications/Reminders.app/Contents/MacOS/Reminders"
      ],
      "notes": "Block all stock consumer apps"
    },
    {
      "action": "deny",
      "direction": "both",
      "process": "AnyProcess",
      "remote-addresses": "224.0.0.0/4,239.0.0.0/8,ff00::/8,169.254.0.0/16,255.255.255.255",
      "notes": "Block multicast, broadcast, link-local \u2014 stay invisible on LAN"
    },
    {
      "action": "deny",
      "direction": "incoming",
      "process": "AnyProcess",
      "notes": "No unsolicited inbound connections"
    }
  ]
}
